<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="keywords" content="Polars, cheat sheet" />
    <meta name="author" content="Franz Diebold" />

    <title>Polars Cheat Sheet</title>

    <link rel="stylesheet" href="A4.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/github.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
    <script>
      hljs.highlightAll();
    </script>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="page">
      <div class="columns content-columns">
        <div class="column is-3">
          <div class="has-text-centered">
            <a href="https://www.pola.rs/" target="_blank"
              ><img src="images/Polars-logo.svg" class="logo"
            /></a>

            <h1 class="title is-4">
              <a href="https://www.pola.rs/" target="_blank">Polars</a>
              Cheat Sheet
            </h1>
            <a
              href="https://colab.research.google.com/github/FranzDiebold/polars-cheat-sheet/blob/main/polars-cheat-sheet.ipynb"
              target="_blank"
              ><img
                src="https://colab.research.google.com/assets/colab-badge.svg"
                class="badge"
            /></a>
          </div>

          <h3>General</h3>

          <div class="group">
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/quickstart/intro.html#installation"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <h4>Install</h4>
            <pre><code class="language-bash">pip install polars</code></pre>
          </div>

          <div class="group">
            <h4>Import</h4>
            <pre><code class="language-python">import polars as pl</code></pre>
          </div>

          <h3>Creating/reading DataFrames</h3>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Create DataFrame</p>
            <div class="image">
              <img src="images/create_data_frame.svg" />
            </div>
            <pre><code class="language-python">df = pl.DataFrame(
  {
    "nrs": [1, 2, 3, None, 5],
    "names": ["foo", "ham", "spam", "egg", None],
    "random": [0.3, 0.7, 0.1, 0.9, 0.6],
    "groups": ["A", "A", "B", "C", "B"],
  }
)</code></pre>
          </div>

          <div class="group">
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/howcani/io/csv.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Read CSV</p>
            <pre><code class="language-python">df = pl.read_csv("https://j.mp/iriscsv",
                 has_header=True)</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/howcani/io/parquet.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Read parquet</p>
            <pre><code class="language-python">df = pl.read_parquet("path.parquet",
                     columns=["select", "columns"])</code></pre>
          </div>

          <h3>Expressions</h3>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/dsl/expressions.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>
              Polars expressions can be performed in sequence. This improves
              readability of code.
            </p>
            <pre><code class="language-python">df \
  .filter(pl.col("nrs") < 4) \
  .groupby("groups") \
  .agg(
    pl \
      .all() \
      .sum()
)</code></pre>
          </div>
        </div>

        <div class="column is-3">
          <h3>Subset Observations - rows</h3>
          <div class="image">
            <img src="images/subset_observations.svg" />
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/dsl/expressions.html#filter-and-conditionals"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Filter: Extract rows that meet logical criteria.</p>
            <pre><code class="language-python">df.filter(pl.col("random") > 0.5)
df.filter(
  (pl.col("groups") == "B")
  & (pl.col("random") > 0.5)
)</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.sample.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Sample</p>
            <pre><code class="language-python"># Randomly select fraction of rows.
df.sample(frac=0.5)

# Randomly select n rows.
df.sample(n=2)</code></pre>
          </div>
          <div class="group">
            <p>Select first and last rows</p>
            <pre><code class="language-python"># Select first n rows
df.head(n=2)

# Select last n rows.
df.tail(n=2)</code></pre>
          </div>

          <h3>Subset Variables - columns</h3>
          <div class="image">
            <img src="images/subset_variables.svg" />
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/howcani/selecting_data/selecting_data_expressions.html#select-a-list-of-columns"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Select multiple columns with specific names</p>
            <pre><code class="language-python">df.select(["nrs", "names"])</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/howcani/selecting_data/selecting_data_expressions.html#select-columns-with-an-expression"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Select columns whose name matches regex</p>
            <pre><code class="language-python">df.select(pl.col("^n.*$"))</code></pre>
          </div>

          <h3>Subsets - rows and columns</h3>
          <div class="image">
            <img src="images/subsets_rows_and_columns.svg" />
          </div>
          <div class="group">
            <p>Select rows 2-4</p>
            <pre><code class="language-python">df[2:4, :]</code></pre>
          </div>
          <div class="group">
            <p>Select columns in positions 1 and 3 (first column is 0)</p>
            <pre><code class="language-python">df[:, [1, 3]]</code></pre>
          </div>
          <div class="group">
            <p>
              Select rows meeting logical condition, and only the specific
              columns
            </p>
            <pre><code class="language-python">df[df["random"] > 0.5, ["names", "groups"]]</code></pre>
          </div>
        </div>

        <div class="column is-3">
          <h3>Reshaping Data â€“ Change layout, sorting, renaming</h3>
          <div class="group">
            <div class="image">
              <img src="images/concat_rows.svg" />
            </div>
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/howcani/combining_data/concatenating.html#vertical-concatenation---getting-longer"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Append rows of DataFrames</p>
            <pre><code class="language-python">pl.concat([df, df2])</code></pre>
          </div>

          <div class="group">
            <div class="image">
              <img src="images/concat_columns.svg" />
            </div>
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/howcani/combining_data/concatenating.html#horizontal-concatenation---getting-wider"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Append columns of DataFrames</p>
            <pre><code class="language-python">pl.concat([df, df3], how="horizontal")</code></pre>
          </div>

          <div class="group">
            <div class="image">
              <img src="images/melt.svg" />
            </div>
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.melt.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Gather columns into rows</p>
            <pre><code class="hljs nohighlight">df.melt(
  <span class="is-underlined underlined-green">id_vars</span>=<span class="hljs-string">"nrs"</span>,
  <span class="is-underlined underlined-yellow">value</span><span class="is-underlined underlined-red">_vars</span>=[<span class="hljs-string">"names"</span>, <span class="hljs-string">"groups"</span>]
)</code></pre>
          </div>
          <div class="group">
            <div class="image">
              <img src="images/pivot.svg" />
            </div>
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.pivot.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Spread rows into columns</p>
            <pre><code class="hljs nohighlight">df.pivot(<span class="is-underlined underlined-yellow">values</span>=<span class="hljs-string">"nrs"</span>, <span class="is-underlined underlined-green">index</span>=<span class="hljs-string">"groups"</span>,
         <span class="is-underlined underlined-red">columns</span>=<span class="hljs-string">"names"</span>)</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.sort.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Order rows by values of a column</p>
            <pre><code class="language-python"># low to high
df.sort("random")

# high to low
df.sort("random", reverse=True)</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.rename.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Rename the columns of a DataFrame</p>
            <pre><code class="language-python">df.rename({"nrs": "idx"})</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.drop.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Drop columns from DataFrame</p>
            <pre><code class="language-python">df.drop(["names", "random"])</code></pre>
          </div>
        </div>

        <div class="column is-3">
          <h3>Summarize Data</h3>
          <div class="group">
            <p>Count number of rows with each unique value of variable</p>
            <pre><code class="language-python">df["groups"].value_counts()</code></pre>
          </div>
          <div class="group">
            <p># of rows in DataFrame</p>
            <pre><code class="language-python">len(df)
# or
df.height</code></pre>
          </div>
          <div class="group">
            <p>Tuple of # of rows, # of columns in DataFrame</p>
            <pre><code class="language-python">df.shape</code></pre>
          </div>
          <div class="group">
            <p># of distinct values in a column</p>
            <pre><code class="language-python">df["groups"].n_unique()</code></pre>
          </div>
          <div class="group">
            <div class="image">
              <img src="images/describe.svg" />
            </div>
            <p>Basic descriptive and statistics for each column</p>
            <pre><code class="language-python">df.describe()</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/dsl/expressions.html#various-aggregations"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Aggregation functions</p>
            <pre><code class="language-python">df.select(
    [
      # Sum values
      pl.sum("random").alias("sum"),

      # Minimum value
      pl.min("random").alias("min"),

      # Maximum value
      pl.max("random").alias("max"),
      # or
      pl.col("random").max().alias("other_max"),

      # Standard deviation
      pl.std("random").alias("std dev"),

      # Variance
      pl.var("random").alias("variance"),

      # Median
      pl.median("random").alias("median"),

      # Mean
      pl.mean("random").alias("mean"),

      # Quantile
      pl.quantile("random", 0.75) \
        .alias("quantile_0.75"),
      # or
      pl.col("random").quantile(0.75) \
        .alias("other_quantile_0.75"),

      # First value
      pl.first("random").alias("first"),
    ]
)</code></pre>
          </div>
        </div>
      </div>

      <div class="columns info-columns">
        <div class="column is-half">
          <span class="infos">
            Download at
            <a href="https://polars.diebold.io" target="_blank"
              >polars.diebold.io</a
            >
          </span>
        </div>
        <div class="column is-half has-text-right">
          <span class="infos-small"
            >By Franz Diebold (<a href="https://www.diebold.io" target="_blank"
              >diebold.io</a
            >), inspired by
            <a
              href="https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf"
              target="_blank"
              >Pandas Cheat Sheet</a
            ></span
          >
        </div>
      </div>
    </div>

    <div class="page">
      <div class="columns content-columns">
        <div class="column is-3">
          <h3>Group Data</h3>
          <div class="image">
            <img src="images/groupby.svg" />
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars-book/user-guide/dsl/groupby.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>
              Group by values in column named "col", returning a GroupBy object
            </p>
            <pre><code class="language-python">df.groupby("groups")</code></pre>
          </div>
          <div class="group">
            <p>
              All of the aggregation functions from above can be applied to a
              group as well
            </p>
            <pre><code class="language-python">df.groupby(by="groups").agg(
  [
      # Sum values
      pl.sum("random").alias("sum"),

      # Minimum value
      pl.min("random").alias("min"),

      # Maximum value
      pl.max("random").alias("max"),
      # or
      pl.col("random").max().alias("other_max"),

      # Standard deviation
      pl.std("random").alias("std_dev"),

      # Variance
      pl.var("random").alias("variance"),

      # Median
      pl.median("random").alias("median"),

      # Mean
      pl.mean("random").alias("mean"),

      # Quantile
      pl.quantile("random", 0.75) \
        .alias("quantile_0.75"),
      # or
      pl.col("random").quantile(0.75) \
        .alias("other_quantile_0.75"),

      # First value
      pl.first("random").alias("first"),
  ]
)</code></pre>
          </div>
          <div class="group">
            <p>Additional GroupBy functions</p>
            <pre><code class="language-python">df.groupby(by="groups").agg(
  [
    # Count the number of values in each group
    pl.count("random").alias("size"),

    # Sample one element in each group
    pl.col("names").apply(
      lambda group_df: group_df.sample(1)
    ),
  ]
)</code></pre>
          </div>
        </div>

        <div class="column is-3">
          <h3>Handling Missing Data</h3>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.drop_nulls.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Drop rows with any column having a null value</p>
            <pre><code class="language-python">df.drop_nulls()</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.fill_null.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Replace null values with given value</p>
            <pre><code class="language-python">df.fill_null(42)</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.fill_nan.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Replace floating point NaN values with given value</p>
            <pre><code class="language-python">df.fill_nan(42)</code></pre>
          </div>

          <h3>Make New Columns</h3>
          <div class="image">
            <img src="images/new_columns.svg" />
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.with_column.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Add a new columns to the DataFrame</p>
            <pre><code class="language-python">df.with_column(
  (pl.col("random") * pl.col("nrs")) \
    .alias("product")
)</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.with_columns.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Add several new columns to the DataFrame</p>
            <pre><code class="language-python">df.with_columns(
    [
        (pl.col("random") * pl.col("nrs")) \
          .alias("product"),
        pl.col("names").str.lengths() \
          .alias("names_lengths"),
    ]
)</code></pre>
          </div>
          <div class="group">
            <a
              href="https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.with_row_count.html"
              target="_blank"
            >
              <span class="icon"
                ><svg viewBox="0 0 24 24">
                  <path
                    fill="currentColor"
                    d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"
                  /></svg></span
            ></a>
            <p>Add a column at index 0 that counts the rows</p>
            <pre><code class="language-python">df.with_row_count()</code></pre>
          </div>
        </div>

        <div class="column is-3">
          <h3>Rolling Functions</h3>
          <div class="group">
            <p>The following rolling functions are available</p>
            <pre><code class="language-python">df.select(
    [
        # Rolling maximum value
        pl.col("random") \
          .rolling_max(window_size=2) \
          .alias("rolling_max"),

        # Rolling mean value
        pl.col("random") \
          .rolling_mean(window_size=2) \
          .alias("rolling_mean"),

        # Rolling median value
        pl.col("random") \
          .rolling_median(
              window_size=2, min_periods=2) \
          .alias("rolling_median"),

        # Rolling minimum value
        pl.col("random") \
          .rolling_min(window_size=2) \
          .alias("rolling_min"),

        # Rolling standard deviation
        pl.col("random") \
          .rolling_std(window_size=2) \
          .alias("rolling_std"),

        # Rolling sum values
        pl.col("random") \
          .rolling_sum(window_size=2) \
          .alias("rolling_sum"),

        # Rolling variance
        pl.col("random") \
          .rolling_var(window_size=2) \
          .alias("rolling_var"),

        # Rolling custom function
        pl.col("random") \
          .rolling_apply(
            function=np.nanstd, window_size=2) \
          .alias("rolling_apply"),
    ]
)</code></pre>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
